<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Applies the Hardy-Cross method to solve for pipe flows in a network. — hardycross • hydraulics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Applies the Hardy-Cross method to solve for pipe flows in a network. — hardycross"><meta name="description" content="This function uses the Hardy-Cross method to iteratively solve the
equations for conservation of mass and energy in a water pipe network.
The input consists of a data frame with the pipe characteristics and lists
of the pipes in each loop (listed in a clockwise direction) and the initial
guesses of flows in each pipe (positive flows are in a clockwise direction)."><meta property="og:description" content="This function uses the Hardy-Cross method to iteratively solve the
equations for conservation of mass and energy in a water pipe network.
The input consists of a data frame with the pipe characteristics and lists
of the pipes in each loop (listed in a clockwise direction) and the initial
guesses of flows in each pipe (positive flows are in a clockwise direction)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydraulics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/hydraulics_vignette.html">Hydraulics Vignette</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EdM44/hydraulics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Applies the Hardy-Cross method to solve for pipe flows in a network.</h1>
      <small class="dont-index">Source: <a href="https://github.com/EdM44/hydraulics/blob/HEAD/R/hardy-cross.R" class="external-link"><code>R/hardy-cross.R</code></a></small>
      <div class="d-none name"><code>hardycross.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses the Hardy-Cross method to iteratively solve the
equations for conservation of mass and energy in a water pipe network.
The input consists of a data frame with the pipe characteristics and lists
of the pipes in each loop (listed in a clockwise direction) and the initial
guesses of flows in each pipe (positive flows are in a clockwise direction).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hardycross</span><span class="op">(</span></span>
<span>  dfpipes <span class="op">=</span> <span class="va">dfpipes</span>,</span>
<span>  loops <span class="op">=</span> <span class="va">loops</span>,</span>
<span>  Qs <span class="op">=</span> <span class="va">Qs</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SI"</span>, <span class="st">"Eng"</span><span class="op">)</span>,</span>
<span>  ret_units <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dfpipes">dfpipes<a class="anchor" aria-label="anchor" href="#arg-dfpipes"></a></dt>
<dd><p>data frame with the pipe data. Format is described above, but must contain a column named _ID_.</p></dd>


<dt id="arg-loops">loops<a class="anchor" aria-label="anchor" href="#arg-loops"></a></dt>
<dd><p>integer list defining pipes in each loop of the network.</p></dd>


<dt id="arg-qs">Qs<a class="anchor" aria-label="anchor" href="#arg-qs"></a></dt>
<dd><p>numeric list of initial flows for each pipe in each loop [\(m^3 s^{-1}\) or \(ft^3 s^{-1}\)]</p></dd>


<dt id="arg-n-iter">n_iter<a class="anchor" aria-label="anchor" href="#arg-n-iter"></a></dt>
<dd><p>integer identifying the number of iterations to perform.</p></dd>


<dt id="arg-units">units<a class="anchor" aria-label="anchor" href="#arg-units"></a></dt>
<dd><p>character vector that contains the system of units [options are
<code>SI</code> for International System of Units and <code>Eng</code> for English (US customary)
units.</p></dd>


<dt id="arg-ret-units">ret_units<a class="anchor" aria-label="anchor" href="#arg-ret-units"></a></dt>
<dd><p>If set to TRUE the value(s) returned for pipe flows are of
class <code>units</code> with units attached to the value. [Default is FALSE]</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list of two data frames:</p><ul><li><p>dfloops - the final flow magnitude and direction (clockwise positive) for each loop and pipe</p></li>
<li><p>dfpipes - the input pipe data frame, with additional columns including final Q</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The input data frame with the pipe data must contain a pipe ID column with
the pipe numbers used in the loops input list. There are three options for
input column of the pipe roughness data frame:</p><table class="table table"><tr><td><strong>Column Name</strong></td><td><strong>Approach for Determining K</strong></td></tr><tr><td>ks</td><td>f calculated using Colebrook equation, K using Darcy-Weisbach</td></tr><tr><td>f</td><td>f treated as fixed, K calculated using Darcy-Weisbach</td></tr><tr><td>K</td><td>K treated as fixed</td></tr></table><p>In the case where absolute pipe roughness, \(ks\) (in m or ft), is input,
  the input pipe data frame must also include columns for the length, \(L\) and
  diameter, \(D\), (both in m or ft) so \(K\) can be calculated. In this case,
  a new \(f\) and \(K\) are calculated at each iteration, the final values of
  which are included in the output. If input \(K\) or \(f\) columns are provided, values
  for \(ks\) are ignored. If an input \(K\) column is provided, \(ks\) and \(f\) are
  ignored. If the Colebrook equation is used to determine \(f\), a water
  temperature of \(20^{o}C\) or \(68^{o}F\) is used.</p>
<p>The number of iterations to perform may be specified with the n_iter input
  value, but execution stops if the average flow adjustment becomes smaller
  than 1 percent of the average flow in all pipes.</p>
<p>The Darcy-Weisbach equation is used to estimate the head loss in each
pipe segment, expressed in a condensed form as \(h_f = KQ^{2}\)
where: $$K = \frac{8fL}{\pi^{2}gD^{5}}$$
If needed, the friction factor \(f\) is calculated using the Colebrook
equation. The flow adjustment in each loop is calculated at each iteration as:
$$\Delta{Q_i} = -\frac{\sum_{j=1}^{p_i} K_{ij}Q_j|Q_j|}{\sum_{j=1}^{p_i} 2K_{ij}Q_j^2}$$
where \(i\) is the loop number, \(j\) is the pipe number, \(p_i\) is the number of
pipes in loop \(i\) and \(\Delta{Q_i}\) is the flow adjustment to be applied
to each pipe in loop \(i\) for the next iteration.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="colebrook.html">colebrook</a></code>, <code><a href="darcyweisbach.html">darcyweisbach</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#              A----------B --&gt; 0.5m^3/s</span></span></span>
<span class="r-in"><span><span class="co">#              |\   (4)   |</span></span></span>
<span class="r-in"><span><span class="co">#              | \        |</span></span></span>
<span class="r-in"><span><span class="co">#              |  \       |</span></span></span>
<span class="r-in"><span><span class="co">#              |   \(2)   |</span></span></span>
<span class="r-in"><span><span class="co">#              |    \     |(5)</span></span></span>
<span class="r-in"><span><span class="co">#              |(1)  \    |</span></span></span>
<span class="r-in"><span><span class="co">#              |      \   |</span></span></span>
<span class="r-in"><span><span class="co">#              |       \  |</span></span></span>
<span class="r-in"><span><span class="co">#              |        \ |</span></span></span>
<span class="r-in"><span><span class="co">#              |   (3)   \|</span></span></span>
<span class="r-in"><span><span class="co"># 0.5m^3/s --&gt; C----------D</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Input pipe characteristics data frame. With K given other columns not needed</span></span></span>
<span class="r-in"><span><span class="va">dfpipes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>,                     <span class="co">#pipe ID</span></span></span>
<span class="r-in"><span>K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">2500</span>,<span class="fl">500</span>,<span class="fl">800</span>,<span class="fl">300</span><span class="op">)</span>            <span class="co">#resistance used in hf=KQ^2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">loops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="op">-</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hardycross</span><span class="op">(</span>dfpipes <span class="op">=</span> <span class="va">dfpipes</span>, loops <span class="op">=</span> <span class="va">loops</span>, Qs <span class="op">=</span> <span class="va">Qs</span>, n_iter <span class="op">=</span> <span class="fl">1</span>, units <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using fixed K values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 1, Loop: 1, dQ: -0.02805</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 1, Loop: 2, dQ: 0.02000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dfloops</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   loop pipe        flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1    1  0.27195122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1    2  0.05195122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    1    3 -0.22804878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    2    2 -0.05195122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    2    4  0.22000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    2    5 -0.28000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dfpipes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID    K           Q</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1  200  0.27195122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2 2500  0.05195122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3  500 -0.22804878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  4  800  0.22000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  5  300 -0.28000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ed Maurer, Irucka Embry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

