<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Hydraulics Vignette • hydraulics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hydraulics Vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydraulics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/hydraulics_vignette.html">Hydraulics Vignette</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EdM44/hydraulics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="hydraulics_vignette_files/kePrint-0.0.1/kePrint.js"></script><link href="hydraulics_vignette_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hydraulics Vignette</h1>
                        <h4 data-toc-skip class="author">Ed Maurer</h4>
            
            <h4 data-toc-skip class="date">2024-11-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EdM44/hydraulics/blob/master/vignettes/hydraulics_vignette.Rmd" class="external-link"><code>vignettes/hydraulics_vignette.Rmd</code></a></small>
      <div class="d-none name"><code>hydraulics_vignette.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EdM44/hydraulics" class="external-link">hydraulics</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction-to-the-hydraulics-package">Introduction to the <em>hydraulics</em> package<a class="anchor" aria-label="anchor" href="#introduction-to-the-hydraulics-package"></a>
</h2>
<p>The <em>hydraulics</em> package was developed to augment education in
basic closed conduit and open channel hydraulics. Most common
applications in civil engineering involve water flowing under turbulent
conditions, so the functions make that assumption. If that assumption is
violated, a warning is generated, though that often means there was an
input error. Because engineering calculations are burdened by the
persistence of U.S. customary (often referred to as English) units, all
functions work in either system by designating units as either
<em>SI</em> or <em>Eng</em>.</p>
<div class="section level3">
<h3 id="water-properties">1.0 Water properties<a class="anchor" aria-label="anchor" href="#water-properties"></a>
</h3>
<p>When describing the behavior of water in pipes and channels under
turbulent flow conditions there are three water properties used used in
calculations, all of which vary with water temperature: density
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>),
dynamic
viscosity(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>),
and kinematic
viscosity(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>),
where they are related by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>=</mo><mfrac><mi>μ</mi><mi>ρ</mi></mfrac></mrow><annotation encoding="application/x-tex">\nu=\frac{\mu}{\rho}</annotation></semantics></math>.
An additional function exists for saturated vapor pressure of water.</p>
<p>These properties are found using the <em>dens</em>, <em>dvisc</em>,
<em>kvisc</em>, and <em>svp</em> functions. For example, the kinematic
viscosity for water temperature of 55
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^\circ</annotation></semantics></math>F
is found as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nu</span> <span class="op">=</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T <span class="op">=</span> <span class="fl">55</span>, units <span class="op">=</span> <span class="st">'Eng'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Kinematic viscosity: %.3e ft2/s\n"</span>, <span class="va">nu</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Kinematic viscosity: 1.318e-05 ft2/s</span></span></code></pre></div>
<p>Similarly the water density for water temperature of 25
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^\circ</annotation></semantics></math>C
can be determined by:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rho</span> <span class="op">=</span> <span class="fu"><a href="../reference/waterprops.html">dens</a></span><span class="op">(</span>T <span class="op">=</span> <span class="fl">25</span>, units <span class="op">=</span> <span class="st">'SI'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Water density: %.3f kg/m3\n"</span>, <span class="va">rho</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Water density: 997.075 kg/m3</span></span></code></pre></div>
<p>The water property functions can all accept a list of input
temperature values, enabling visualization of a property with varying
water temperature, for example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">nus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T <span class="op">=</span> <span class="va">Ts</span>, units <span class="op">=</span> <span class="st">'SI'</span><span class="op">)</span></span>
<span><span class="va">xlbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Temperature, "</span> <span class="op">(</span><span class="va">degree</span><span class="op">*</span><span class="va">C</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ylbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Kinematic viscosity,"</span> <span class="op">~</span><span class="va">nu</span><span class="op">~</span> <span class="op">(</span><span class="va">m</span><span class="op">^</span><span class="op">{</span><span class="fl">2</span><span class="op">}</span><span class="op">/</span><span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.8</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.7</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Ts</span>, <span class="va">nus</span>, xlab <span class="op">=</span> <span class="va">xlbl</span>, ylab <span class="op">=</span> <span class="va">ylbl</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/waterprops-3-1.png" width="50%"></p>
<p>The water property functions can also be called with the
<em>ret_units</em> parameter, in which case the function returns an
object of class <em>units</em>, as designated by the package <a href="https://cran.r-project.org/package=units" class="external-link">units</a>. This enables
capabilities for new units being deduced as operations are performed on
the values. Concise examples are in the <a href="https://cran.r-project.org/package=units" class="external-link">vignettes for the
‘units’ package</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">Dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waterprops.html">dens</a></span><span class="op">(</span>T <span class="op">=</span> <span class="cn">T</span>, units <span class="op">=</span> <span class="st">'SI'</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Dvisc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waterprops.html">dvisc</a></span><span class="op">(</span>T <span class="op">=</span> <span class="cn">T</span>, units <span class="op">=</span> <span class="st">'SI'</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#Calculate kinematic viscosity and units are generated correctly</span></span>
<span><span class="va">Kvisc</span> <span class="op">&lt;-</span> <span class="va">Dvisc</span> <span class="op">/</span> <span class="va">Dens</span></span>
<span><span class="va">Kvisc</span></span>
<span><span class="co">#&gt; 9.134879e-07 [m*N*s/kg]</span></span></code></pre></div>
<p>While the units are correct, they are not in their simplified form.
That can be done by setting new units. Unit conversions are done the
same way.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">Kvisc</span>, <span class="va">m</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="co">#&gt; 9.134879e-07 [m^2/s]</span></span>
<span><span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">Kvisc</span>, <span class="va">ft</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="co">#&gt; 9.832702e-06 [ft^2/s]</span></span></code></pre></div>
<p>An example finding the saturated vapor pressure to water at 10
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^\circ</annotation></semantics></math>C
follows.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waterprops.html">svp</a></span><span class="op">(</span>T <span class="op">=</span> <span class="fl">10</span>, units <span class="op">=</span> <span class="st">"SI"</span>, ret_units <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">vps</span></span>
<span><span class="co">#&gt; 1228.188 [Pa]</span></span>
<span><span class="co">#convert to psi - notice the need to enclose "in" with backticks since "in" </span></span>
<span><span class="co">#has other meanings in R</span></span>
<span><span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">vps</span>,<span class="va">lbf</span><span class="op">/</span><span class="va">`in`</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.1781336 [lbf/in^2]</span></span></code></pre></div>
<p>If the results are of class <em>units</em> they also can have the
units plot without the cumbersome formatting of axis labels.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Temperature</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>, <span class="va">degree_Celsius</span><span class="op">)</span></span>
<span><span class="va">Kinematic_Viscosity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T <span class="op">=</span> <span class="va">Temperature</span>, units <span class="op">=</span> <span class="st">'SI'</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.8</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"mar"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Temperature</span>, <span class="va">Kinematic_Viscosity</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/waterprops-7-1.png" width="50%"></p>
<p>Sometimes it is useful to have a table containing water properties
organized by temperature. The ‘hydraulics’ package includes a
<em>water_table</em> function to generate a table in either <em>SI</em>
or <em>Eng</em> units.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/water_table.html">water_table</a></span><span class="op">(</span>units <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 8</span></span></span>
<span><span class="co">#&gt;    Temp  Density Spec_Weight Viscosity  Kinem_Visc Sat_VP Surf_Tens   Bulk_Mod</span></span>
<span><span class="co">#&gt;     <span style="color: #949494;">[C]</span> <span style="color: #949494;">[kg/m^3]</span>     <span style="color: #949494;">[N/m^3]</span> <span style="color: #949494;">[N*s/m^2]</span>     <span style="color: #949494;">[m^2/s]</span>   <span style="color: #949494;">[Pa]</span>     <span style="color: #949494;">[N/m]</span>       <span style="color: #949494;">[Pa]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    0    <span style="text-decoration: underline;">1</span>000.       <span style="text-decoration: underline;">9</span>809.  0.001<span style="text-decoration: underline;">73</span>  0.000<span style="text-decoration: underline;">001</span>73    611.    0.075<span style="text-decoration: underline;">7</span> <span style="text-decoration: underline;">2</span>020<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    5    <span style="text-decoration: underline;">1</span>000.       <span style="text-decoration: underline;">9</span>810.  0.001<span style="text-decoration: underline;">50</span>  0.000<span style="text-decoration: underline;">001</span>50    873.    0.074<span style="text-decoration: underline;">9</span> <span style="text-decoration: underline;">2</span>060<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   10    <span style="text-decoration: underline;">1</span>000.       <span style="text-decoration: underline;">9</span>807.  0.001<span style="text-decoration: underline;">31</span>  0.000<span style="text-decoration: underline;">001</span>31   <span style="text-decoration: underline;">1</span>228.    0.074<span style="text-decoration: underline;">2</span> <span style="text-decoration: underline;">2</span>100<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   15     999.       <span style="text-decoration: underline;">9</span>801.  0.001<span style="text-decoration: underline;">15</span>  0.000<span style="text-decoration: underline;">001</span>15   <span style="text-decoration: underline;">1</span>706.    0.073<span style="text-decoration: underline;">5</span> <span style="text-decoration: underline;">2</span>140<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   20     998.       <span style="text-decoration: underline;">9</span>793.  0.001<span style="text-decoration: underline;">02</span>  0.000<span style="text-decoration: underline;">001</span>02   <span style="text-decoration: underline;">2</span>339.    0.072<span style="text-decoration: underline;">7</span> <span style="text-decoration: underline;">2</span>180<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   25     997.       <span style="text-decoration: underline;">9</span>781.  0.000<span style="text-decoration: underline;">911</span> 0.000<span style="text-decoration: underline;">000</span>913  <span style="text-decoration: underline;">3</span>170.    0.072<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>220<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   30     996.       <span style="text-decoration: underline;">9</span>768.  0.000<span style="text-decoration: underline;">817</span> 0.000<span style="text-decoration: underline;">000</span>821  <span style="text-decoration: underline;">4</span>247.    0.071<span style="text-decoration: underline;">2</span> <span style="text-decoration: underline;">2</span>250<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   35     994.       <span style="text-decoration: underline;">9</span>752.  0.000<span style="text-decoration: underline;">738</span> 0.000<span style="text-decoration: underline;">000</span>742  <span style="text-decoration: underline;">5</span>629.    0.070<span style="text-decoration: underline;">4</span> <span style="text-decoration: underline;">2</span>265<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   40     992.       <span style="text-decoration: underline;">9</span>734.  0.000<span style="text-decoration: underline;">670</span> 0.000<span style="text-decoration: underline;">000</span>675  <span style="text-decoration: underline;">7</span>385.    0.069<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>280<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   45     990.       <span style="text-decoration: underline;">9</span>714.  0.000<span style="text-decoration: underline;">611</span> 0.000<span style="text-decoration: underline;">000</span>617  <span style="text-decoration: underline;">9</span>595.    0.068<span style="text-decoration: underline;">8</span> <span style="text-decoration: underline;">2</span>285<span style="text-decoration: underline;">000</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more rows</span></span></span></code></pre></div>
<p>The table can be reformatted to something more attractive using the
<a href="https://cran.r-project.org/package=kableExtra" class="external-link">kableExtra</a>
and <a href="https://cran.r-project.org/package=formatdown" class="external-link">formatdown</a>
packages.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manage units</span></span>
<span><span class="va">unitlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span>, <span class="fu">units</span><span class="fu">::</span><span class="va"><a href="https://r-quantities.github.io/units/reference/deparse_unit.html" class="external-link">deparse_unit</a></span><span class="op">)</span></span>
<span><span class="va">colnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/drop_units.html" class="external-link">drop_units</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign size argument for table output</span></span>
<span><span class="fu">formatdown</span><span class="fu">::</span><span class="fu"><a href="https://graphdr.github.io/formatdown/reference/formatdown_options.html" class="external-link">formatdown_options</a></span><span class="op">(</span>size <span class="op">=</span> <span class="st">"small"</span><span class="op">)</span></span>
<span><span class="co"># Format text as-is (i.e., as integers)</span></span>
<span><span class="va">tbl</span><span class="op">$</span><span class="va">Temp</span> <span class="op">&lt;-</span> <span class="fu">formatdown</span><span class="fu">::</span><span class="fu"><a href="https://graphdr.github.io/formatdown/reference/format_text.html" class="external-link">format_text</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">$</span><span class="va">Temp</span><span class="op">)</span></span>
<span><span class="co"># Format decimals to 4 significant digits</span></span>
<span><span class="va">cols_we_want</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Density"</span>, <span class="st">"Spec_Weight"</span><span class="op">)</span></span>
<span><span class="va">tbl</span><span class="op">[</span>, <span class="va">cols_we_want</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span>, <span class="va">cols_we_want</span><span class="op">]</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu">formatdown</span><span class="fu">::</span><span class="fu"><a href="https://graphdr.github.io/formatdown/reference/format_dcml.html" class="external-link">format_dcml</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Format using power-of-ten notation to 4 significant digits</span></span>
<span><span class="va">cols_we_want</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Viscosity"</span>, <span class="st">"Kinem_Visc"</span><span class="op">)</span></span>
<span><span class="va">tbl</span><span class="op">[</span>, <span class="va">cols_we_want</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span>, <span class="va">cols_we_want</span><span class="op">]</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu">formatdown</span><span class="fu">::</span><span class="fu"><a href="https://graphdr.github.io/formatdown/reference/format_engr.html" class="external-link">format_engr</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Exponent set to 3 for all entries</span></span>
<span><span class="va">tbl</span><span class="op">$</span><span class="va">Sat_VP</span> <span class="op">&lt;-</span> <span class="fu">formatdown</span><span class="fu">::</span><span class="fu"><a href="https://graphdr.github.io/formatdown/reference/format_engr.html" class="external-link">format_engr</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">$</span><span class="va">Sat_VP</span>, digits <span class="op">=</span> <span class="fl">4</span>, set_power <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># Format using power-of-ten notation to 3 significant digits</span></span>
<span><span class="va">cols_we_want</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Surf_Tens"</span>, <span class="st">"Bulk_Mod"</span><span class="op">)</span></span>
<span><span class="va">tbl</span><span class="op">[</span>, <span class="va">cols_we_want</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span>, <span class="va">cols_we_want</span><span class="op">]</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu">formatdown</span><span class="fu">::</span><span class="fu"><a href="https://graphdr.github.io/formatdown/reference/format_engr.html" class="external-link">format_engr</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Reset size option</span></span>
<span><span class="fu">formatdown</span><span class="fu">::</span><span class="fu"><a href="https://graphdr.github.io/formatdown/reference/formatdown_options.html" class="external-link">formatdown_options</a></span><span class="op">(</span>reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl2</span> <span class="op">&lt;-</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tbl</span>, col.names <span class="op">=</span> <span class="va">unitlist</span>, align <span class="op">=</span> <span class="st">"c"</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_header_above.html" class="external-link">add_header_above</a></span><span class="op">(</span><span class="va">tbl2</span>, header <span class="op">=</span> <span class="va">colnames</span>, line <span class="op">=</span> <span class="cn">F</span>, align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="">
Temp
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="">
Density
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="">
Spec_Weight
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="">
Viscosity
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="">
Kinem_Visc
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="">
Sat_VP
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="">
Surf_Tens
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="">
Bulk_Mod
</div>
</th>
</tr>
<tr>
<th style="text-align:center;">
C
</th>
<th style="text-align:center;">
kg m-3
</th>
<th style="text-align:center;">
N m-3
</th>
<th style="text-align:center;">
N s m-2
</th>
<th style="text-align:center;">
m2 s-1
</th>
<th style="text-align:center;">
Pa
</th>
<th style="text-align:center;">
N m-1
</th>
<th style="text-align:center;">
Pa
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{0}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 999.9$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9809$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.734 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.734 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 0.6112 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 75.7 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.02 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{5}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1000$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9810$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.501 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.501 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 0.8726 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 74.9 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.06 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{10}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 999.7$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9807$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.310 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.311 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.228 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 74.2 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.10 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{15}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 999.1$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9801$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.153 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.154 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.706 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 73.5 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.14 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{20}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 998.2$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9793$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.021 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 1.023 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.339 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 72.7 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.18 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{25}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 997.1$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9781$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 910.8 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 913.5 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 3.170 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 72.0 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.22 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{30}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 995.7$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9768$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 817.4 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 821.0 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 4.247 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 71.2 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.25 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{35}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 994.1$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9752$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 738.0 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 742.4 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 5.629 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 70.4 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.26 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{40}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 992.2$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9734$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 669.9 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 675.1 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 7.385 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 69.6 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.28 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{45}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 990.2$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9714$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 611.2 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 617.3 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9.595 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 68.8 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.28 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{50}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 988.1$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9693$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 560.5 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 567.2 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 12.35 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 67.9 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.29 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{55}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 985.7$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9670$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 516.2 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 523.7 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 15.76 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 67.1 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.28 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{60}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 983.2$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9645$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 477.6 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 485.7 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 19.95 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 66.2 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.28 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{65}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 980.6$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9619$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 443.5 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 452.3 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 25.04 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 65.4 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.26 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{70}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 977.7$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9592$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 413.5 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 422.9 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 31.20 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 64.5 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.25 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{75}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 974.8$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9563$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 386.9 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 396.9 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 38.60 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 63.6 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.22 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{80}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 971.7$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9533$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 363.1 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 373.7 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 47.42 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 62.7 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.20 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{85}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 968.5$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9501$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 341.9 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 353.0 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 57.87 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 61.8 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.17 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{90}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 965.2$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9468$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 322.9 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 334.5 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 70.18 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 60.8 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.14 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{95}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 961.7$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9434$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 305.7 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 317.9 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 84.61 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 59.9 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.10 \times 10^{9}$</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">$\small \mathrm{100}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 958.1$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 9399$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 290.2 \times 10^{-6}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 302.9 \times 10^{-9}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 101.4 \times 10^{3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 58.9 \times 10^{-3}$</span>
</td>
<td style="text-align:center;">
<span class="math inline">$\small 2.07 \times 10^{9}$</span>
</td>
</tr>
</tbody>
</table>
<p>While the <em>hydraulics</em> package is focused on water, properties
of the atmosphere are important for characterizing the interaction of
water with air. The is particularly important for phenomena such as
evaporation and condensation. Selected characteristics of the standard
atmosphere, as determined by the International Civil Aviation
Organization (ICAO), are included in the package. Three functions return
different properties of the standard atmosphere:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Returns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">atmtemp</td>
<td align="left">Atmospheric Temperature</td>
</tr>
<tr class="even">
<td align="left">atmpres</td>
<td align="left">Pressure</td>
</tr>
<tr class="odd">
<td align="left">atmdens</td>
<td align="left">Density</td>
</tr>
</tbody>
</table>
<p>All atmospheric functions have input arguments of altitude
(<em>ft</em> or <em>m</em>), unit system (<em>SI</em> or <em>Eng</em>),
and whether or not units should be returned.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/atmosprops.html">atmpres</a></span><span class="op">(</span>alt <span class="op">=</span> <span class="fl">3000</span>, units <span class="op">=</span> <span class="st">"SI"</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; 70121.14 [Pa]</span></span></code></pre></div>
<p>Similar to the water properties table, a summary of the standard
atmosphere can be obtained with the function <em>atmos_table</em>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/atmos_table.html">atmos_table</a></span><span class="op">(</span>units <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span></span>
<span><span class="va">tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 4</span></span></span>
<span><span class="co">#&gt;    Altitude   Temp Pressure  Density</span></span>
<span><span class="co">#&gt;         <span style="color: #949494;">[m]</span>    <span style="color: #949494;">[C]</span>     <span style="color: #949494;">[Pa]</span> <span style="color: #949494;">[kg/m^3]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>        0  15     <span style="text-decoration: underline;">101</span>325     1.23 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     <span style="text-decoration: underline;">1</span>000   8.50   <span style="text-decoration: underline;">89</span>876.    1.11 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     <span style="text-decoration: underline;">2</span>000   2.00   <span style="text-decoration: underline;">79</span>501.    1.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     <span style="text-decoration: underline;">3</span>000  -<span style="color: #BB0000;">4.49</span>   <span style="text-decoration: underline;">70</span>121.    0.909</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     <span style="text-decoration: underline;">4</span>000 -<span style="color: #BB0000;">11.0</span>    <span style="text-decoration: underline;">61</span>660.    0.819</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     <span style="text-decoration: underline;">5</span>000 -<span style="color: #BB0000;">17.5</span>    <span style="text-decoration: underline;">54</span>048.    0.736</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     <span style="text-decoration: underline;">6</span>000 -<span style="color: #BB0000;">24.0</span>    <span style="text-decoration: underline;">47</span>218.    0.660</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     <span style="text-decoration: underline;">7</span>000 -<span style="color: #BB0000;">30.5</span>    <span style="text-decoration: underline;">41</span>105.    0.590</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     <span style="text-decoration: underline;">8</span>000 -<span style="color: #BB0000;">36.9</span>    <span style="text-decoration: underline;">35</span>652.    0.526</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     <span style="text-decoration: underline;">9</span>000 -<span style="color: #BB0000;">43.4</span>    <span style="text-decoration: underline;">30</span>801.    0.467</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    <span style="text-decoration: underline;">10</span>000 -<span style="color: #BB0000;">49.9</span>    <span style="text-decoration: underline;">26</span>500.    0.414</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    <span style="text-decoration: underline;">11</span>000 -<span style="color: #BB0000;">56.4</span>    <span style="text-decoration: underline;">22</span>700.    0.365</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>    <span style="text-decoration: underline;">12</span>000 -<span style="color: #BB0000;">62.9</span>    <span style="text-decoration: underline;">19</span>355.    0.321</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>    <span style="text-decoration: underline;">13</span>000 -<span style="color: #BB0000;">69.3</span>    <span style="text-decoration: underline;">16</span>421.    0.281</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>    <span style="text-decoration: underline;">14</span>000 -<span style="color: #BB0000;">75.8</span>    <span style="text-decoration: underline;">13</span>859.    0.245</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>    <span style="text-decoration: underline;">15</span>000 -<span style="color: #BB0000;">82.3</span>    <span style="text-decoration: underline;">11</span>632.    0.212</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fundamental-constants">2.0 Fundamental constants<a class="anchor" aria-label="anchor" href="#fundamental-constants"></a>
</h3>
<p>Two of the most important descriptive quantities in engineering
hydraulics are the Reynolds number, <em>Re</em> and the Froude number
<em>Fr</em>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mi>V</mi><mi>D</mi></mrow><mi>ν</mi></mfrac></mrow><annotation encoding="application/x-tex">Re=\frac{VD}{\nu}</annotation></semantics></math>
describes the turbulence of the flow. It expresses the ratio of
kinematic forces, expressed by velocity <em>V</em> and a characteristic
length such as pipe diameter, <em>D</em>, to viscous forces as expressed
by the kinematic viscosity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>.
For open channels the characteristic length is the <em>hydraulic
depth</em>, the area of flow divided by the top width. For adequately
turbulent conditions to exists, Reynolds numbers should exceed 4000 for
full pipes, and 2000 for open channels.</p>
<p>For open channel flow, given a channel shape and flow rate, flow can
usually exist at two different depths, termed subcritical (slow, deep)
and supercritical (shallow, fast). The exception is at critical flow
conditions, where only one depth exists, the critical depth. Which depth
is exhibited by the flow is determined by the slope and roughness of the
channel. The Froude number is defined by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>r</mi><mo>=</mo><mfrac><mi>V</mi><msqrt><mrow><mi>g</mi><mi>D</mi></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">Fr=\frac{V}{\sqrt{gD}}</annotation></semantics></math>.
<em>Fr</em> characterizes flow as:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Fr</th>
<th align="left">Condition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">&lt;1.0</td>
<td align="left">subcritical</td>
</tr>
<tr class="even">
<td align="left">=1.0</td>
<td align="left">critical</td>
</tr>
<tr class="odd">
<td align="left">&gt;1.0</td>
<td align="left">supercritical</td>
</tr>
</tbody>
</table>
<p>These constants are calculated internally and returned with the
output of many functions. Critical flow is important in open-channel
flow applications and is discussed further below.</p>
</div>
<div class="section level3">
<h3 id="friction-loss-in-circular-pipes">3.0 Friction Loss in Circular Pipes<a class="anchor" aria-label="anchor" href="#friction-loss-in-circular-pipes"></a>
</h3>
<p>The energy at any point along a pipe containing flowing water is
often described by the energy per unit weight, or energy head, E:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mi>z</mi><mo>+</mo><mfrac><mi>P</mi><mi>γ</mi></mfrac><mo>+</mo><mi>α</mi><mfrac><msup><mi>V</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>g</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">E = z+\frac{P}{\gamma}+\alpha\frac{V^2}{2g}</annotation></semantics></math>
where P is the pressure,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mi>ρ</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">\gamma=\rho g</annotation></semantics></math>
is the specific weight of water, <em>z</em> is the elevation of the
point, <em>V</em> is the average velocity, and each term has units of
length.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is a kinetic energy adjustment factor to account for non-uniform
velocity distribution across the cross-section.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is typically assumed to be 1.0 for turbulent flow because the value is
close to 1.0 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msup><mi>V</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>g</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{V^2}{2g}</annotation></semantics></math>
(the velocity head) tends to be small in relation to other terms in the
equation.</p>
<p>As water flows through a pipe energy is lost due to friction with the
pipe walls and local disturbances (minor losses). The energy loss
between two sections is expressed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mo>−</mo><msub><mi>h</mi><mi>l</mi></msub><mo>=</mo><msub><mi>E</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{E_1} - {h_l} = {E_2}</annotation></semantics></math>.
When pipes are long, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>L</mi><mi>D</mi></mfrac><mo>&gt;</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">\frac{L}{D}&gt;1000</annotation></semantics></math>,
friction losses dominate the energy loss on the system, and the head
loss,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>l</mi></msub><annotation encoding="application/x-tex">h_l</annotation></semantics></math>,
is calculated as the head loss due to friction,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>f</mi></msub><annotation encoding="application/x-tex">h_f</annotation></semantics></math>.
This energy head loss due to friction with the walls of the pipe is
described by the Darcy-Weisbach equation, which estimates the energy
loss per unit weight, or head loss
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>f</mi></msub><annotation encoding="application/x-tex">{h_f}</annotation></semantics></math>,
which has units of length. For circular pipes it is expressed as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>f</mi></msub><mo>=</mo><mfrac><mrow><mi>f</mi><mi>L</mi></mrow><mi>D</mi></mfrac><mfrac><msup><mi>V</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>g</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>8</mn><mi>f</mi><mi>L</mi></mrow><mrow><msup><mi>π</mi><mn>2</mn></msup><mi>g</mi><msup><mi>D</mi><mn>5</mn></msup></mrow></mfrac><msup><mi>Q</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">h_f = \frac{fL}{D}\frac{V^2}{2g} = \frac{8fL}{\pi^{2}gD^{5}}Q^{2}</annotation></semantics></math>
In this equation <em>f</em> is the friction factor, typically calculated
with the Colebrook equation:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msqrt><mi>f</mi></msqrt></mfrac><mo>=</mo><mo>−</mo><mn>2</mn><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mfrac><msub><mi>k</mi><mi>s</mi></msub><mi>D</mi></mfrac><mn>3.7</mn></mfrac><mo>+</mo><mfrac><mn>2.51</mn><mrow><mi>R</mi><mi>e</mi><msqrt><mi>f</mi></msqrt></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{1}{\sqrt{f}} = -2\log\left(\frac{\frac{k_s}{D}}{3.7} + \frac{2.51}{Re\sqrt{f}}\right)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>s</mi></msub><annotation encoding="application/x-tex">k_s</annotation></semantics></math>
is the absolute roughness of the pipe wall. There are close
approximations to the Colebrook equation that have an explicit form to
facilitate hand-calculations, but this package only uses the Colebrook
function.</p>
<p>Any one of the variables in the Darcy Weisbach equation, and by
extension the Colebrook equation, may be treated as an unknown. For an
existing pipe with a known flow rate, the friction loss for a length of
pipe may be found:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">20</span><span class="op">/</span><span class="fl">12</span>    <span class="co">#20 inch converted to ft</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fl">10560</span>    <span class="co">#ft</span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fl">4</span>        <span class="co">#ft^3/s</span></span>
<span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">60</span>       <span class="co">#degrees F</span></span>
<span><span class="va">ks</span> <span class="op">&lt;-</span> <span class="fl">0.0005</span>  <span class="co">#ft</span></span>
<span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/darcyweisbach.html">darcyweisbach</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="va">Q</span>,D <span class="op">=</span> <span class="va">D</span>, L <span class="op">=</span> <span class="va">L</span>, ks <span class="op">=</span> <span class="va">ks</span>, </span>
<span>                     nu <span class="op">=</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T<span class="op">=</span><span class="cn">T</span>, units<span class="op">=</span><span class="st">"Eng"</span><span class="op">)</span>, units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Eng"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; hf missing: solving a Type 1 problem</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Reynolds no: %.0f\nFriction Fact: %.4f\nHead Loss: %.2f ft\n"</span>, </span>
<span>            <span class="va">ans</span><span class="op">$</span><span class="va">Re</span>, <span class="va">ans</span><span class="op">$</span><span class="va">f</span>, <span class="va">ans</span><span class="op">$</span><span class="va">hf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reynolds no: 248625</span></span>
<span><span class="co">#&gt; Friction Fact: 0.0173</span></span>
<span><span class="co">#&gt; Head Loss: 5.72 ft</span></span></code></pre></div>
<p>The Reynolds number is adequately high to ensure flow is turbulent
and the Colebrook equation is valid. As with the water properties
function, it can be called with <em>ret_units = TRUE</em> to return a
list of <code>units</code> objects (using the same input as above):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/darcyweisbach.html">darcyweisbach</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="fl">4.0</span>,D <span class="op">=</span> <span class="fl">20</span><span class="op">/</span><span class="fl">12</span>, L <span class="op">=</span> <span class="fl">10560</span>, ks <span class="op">=</span> <span class="fl">0.0005</span>, nu <span class="op">=</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T<span class="op">=</span><span class="cn">T</span>, units<span class="op">=</span><span class="st">"Eng"</span><span class="op">)</span>,</span>
<span>                     units <span class="op">=</span> <span class="st">"Eng"</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"pipe"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">ans</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Q</td>
<td align="left">4 [ft^3/s]</td>
</tr>
<tr class="even">
<td align="left">V</td>
<td align="left">1.8 [ft/s]</td>
</tr>
<tr class="odd">
<td align="left">L</td>
<td align="left">10560 [ft]</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">1.7 [ft]</td>
</tr>
<tr class="odd">
<td align="left">hf</td>
<td align="left">5.7 [ft]</td>
</tr>
<tr class="even">
<td align="left">f</td>
<td align="left">0.017 [1]</td>
</tr>
<tr class="odd">
<td align="left">ks</td>
<td align="left">5e-04 [ft]</td>
</tr>
<tr class="even">
<td align="left">Re</td>
<td align="left">248625 [1]</td>
</tr>
</tbody>
</table>
<p>A new design problem can involve the calculation of a required
diameter for a given head loss and flow rate, so that the pipe has a
specified pressure and flow at some downstream point. An example of that
follows.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fl">37.5</span>     <span class="co">#flow in ft^3/s</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fl">8000</span>     <span class="co">#pipe length in ft</span></span>
<span><span class="va">hf</span> <span class="op">&lt;-</span> <span class="fl">215</span>     <span class="co">#head loss due to friction, in ft</span></span>
<span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">68</span>       <span class="co">#water temperature, F</span></span>
<span><span class="va">ks</span> <span class="op">&lt;-</span> <span class="fl">0.0008</span>  <span class="co">#pipe roughness, ft</span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/darcyweisbach.html">darcyweisbach</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="va">Q</span>, hf <span class="op">=</span> <span class="va">hf</span>, L <span class="op">=</span> <span class="va">L</span>, ks <span class="op">=</span> <span class="va">ks</span>, nu <span class="op">=</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T<span class="op">=</span><span class="cn">T</span>, units<span class="op">=</span><span class="st">'Eng'</span><span class="op">)</span>, units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Eng'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; D missing: solving a Type 3 problem</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Reynolds no: %.0f\nFriction Fact: %.4f\nDiameter: %.2f ft\n"</span>, <span class="va">ans</span><span class="op">$</span><span class="va">Re</span>, <span class="va">ans</span><span class="op">$</span><span class="va">f</span>, <span class="va">ans</span><span class="op">$</span><span class="va">D</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reynolds no: 2336974</span></span>
<span><span class="co">#&gt; Friction Fact: 0.0164</span></span>
<span><span class="co">#&gt; Diameter: 1.85 ft</span></span></code></pre></div>
<p>The usefulness of an R package is not so much for individual
calculations, but repeated trials to see how one variable might vary
with another. For example, it might be interesting to see how the
required diameter varies with changing flow rate. The following example
illustrates the calculation of diameters required to meet the specified
head loss for flows varying from 30 - 45
ft<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>3</mn></msup><annotation encoding="application/x-tex">^3</annotation></semantics></math>/s.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">45</span>, <span class="fl">1.0</span><span class="op">)</span>    <span class="co">#flows in ft^3/s</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fl">8000</span>                 <span class="co">#pipe length in ft</span></span>
<span><span class="va">hf</span> <span class="op">&lt;-</span> <span class="fl">215</span>                 <span class="co">#head loss due to friction, in ft</span></span>
<span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">68</span>                   <span class="co">#water temperature, F</span></span>
<span><span class="va">ks</span> <span class="op">&lt;-</span> <span class="fl">0.0008</span>              <span class="co">#pipe roughness, ft</span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">darcyweisbach</span>, Q<span class="op">=</span><span class="va">Qs</span>, MoreArgs <span class="op">=</span> </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hf <span class="op">=</span> <span class="va">hf</span>, L <span class="op">=</span> <span class="va">L</span>, ks <span class="op">=</span> <span class="va">ks</span>, nu <span class="op">=</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T<span class="op">=</span><span class="cn">T</span>, units<span class="op">=</span><span class="st">'Eng'</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">'Eng'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ans</span><span class="op">$</span><span class="va">Q</span>, <span class="va">ans</span><span class="op">$</span><span class="va">D</span>, xlab <span class="op">=</span> <span class="st">"Q, ft^3/s"</span>, ylab <span class="op">=</span> <span class="st">"D, ft"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/pipe-4-1.png" width="50%"></p>
<p>Another example of the use of this package would be in a laboratory
setting, where pressure measurements are taken at two points along a
straight pipe for a sequence of flow rates to determine pipe roughness.
In this example, the length of pipe is 3 m, the diameter is 25 mm, and
the following head losses were observed for different flow rates:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Q_liter_s</th>
<th align="left">Headloss_m</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0.20</td>
<td align="left">0.052</td>
</tr>
<tr class="even">
<td align="left">0.24</td>
<td align="left">0.073</td>
</tr>
<tr class="odd">
<td align="left">0.30</td>
<td align="left">0.110</td>
</tr>
</tbody>
</table>
<p>The absolute roughness can be calculated by providing the other
variables.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/darcyweisbach.html">darcyweisbach</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="fl">0.00020</span>, hf <span class="op">=</span> <span class="fl">0.052</span>, L <span class="op">=</span> <span class="fl">3.0</span>, D <span class="op">=</span> <span class="fl">0.025</span>, nu <span class="op">=</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T<span class="op">=</span><span class="fl">20</span>, units<span class="op">=</span><span class="st">'SI'</span><span class="op">)</span>, units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'SI'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Absolute roughness: %.6f m\nFriction Factor: %.4f\nDiameter: %.2f m\n"</span>, <span class="va">ans</span><span class="op">$</span><span class="va">ks</span>, <span class="va">ans</span><span class="op">$</span><span class="va">f</span>, <span class="va">ans</span><span class="op">$</span><span class="va">D</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Absolute roughness: 0.000473 m</span></span>
<span><span class="co">#&gt; Friction Factor: 0.0514</span></span>
<span><span class="co">#&gt; Diameter: 0.03 m</span></span></code></pre></div>
<p>Several roughness values can be calculated in one call as shown
below, and the results plotted on a Moody diagram as a reality
check.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Qs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.00020</span>, <span class="fl">0.00024</span>, <span class="fl">0.00030</span><span class="op">)</span> <span class="co">#converted to m^3/s</span></span>
<span><span class="va">hfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.052</span>,<span class="fl">0.073</span>,<span class="fl">0.110</span><span class="op">)</span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">darcyweisbach</span>, Q<span class="op">=</span><span class="va">Qs</span>, hf<span class="op">=</span><span class="va">hfs</span>, MoreArgs <span class="op">=</span> </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>L <span class="op">=</span> <span class="fl">3.0</span>, D <span class="op">=</span> <span class="fl">0.025</span>, nu <span class="op">=</span> <span class="fu"><a href="../reference/waterprops.html">kvisc</a></span><span class="op">(</span>T<span class="op">=</span><span class="fl">20</span>, units<span class="op">=</span><span class="st">'SI'</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">'SI'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ks_values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">ks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ks_values</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.000473 0.000433 0.000397</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\nMean Roughness, ks = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ks_values</span><span class="op">)</span>,<span class="fl">6</span><span class="op">)</span>, <span class="st">" m"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean Roughness, ks = 0.000434 m</span></span>
<span><span class="va">Re_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">Re</span><span class="op">)</span></span>
<span><span class="va">f_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/moody.html">moody</a></span><span class="op">(</span>Re <span class="op">=</span> <span class="va">Re_values</span>, f <span class="op">=</span> <span class="va">f_values</span><span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/pipe-7-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="flow-in-circular-pipes-flowing-partially-full">4.0 Flow in Circular Pipes Flowing Partially Full<a class="anchor" aria-label="anchor" href="#flow-in-circular-pipes-flowing-partially-full"></a>
</h3>
<p>The Manning equation (also known as the Strickler equation) describes
flow conditions in an open channel under uniform flow conditions. It is
often expressed as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>A</mi><mfrac><mi>C</mi><mi>n</mi></mfrac><msup><mi>R</mi><mfrac><mn>2</mn><mn>3</mn></mfrac></msup><msup><msub><mi>S</mi><mi>f</mi></msub><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">Q=A\frac{C}{n}{R}^{\frac{2}{3}}{S_f}^{\frac{1}{2}}</annotation></semantics></math>
where <em>C</em> is 1.0 for <em>SI</em> units and 1.49 for <em>Eng</em>
(U.S. Customary) units. <em>Q</em> is the flow rate, <em>A</em> is the
cross-sectional flow area, <em>n</em> is the Manning roughness
coefficient, and R is the hydraulic radius
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mfrac><mi>A</mi><mi>P</mi></mfrac></mrow><annotation encoding="application/x-tex">R=\frac{A}{P}</annotation></semantics></math>,
where P is the wetted perimeter. Critical depth is defined by the
relation (at critical conditions):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>Q</mi><mn>2</mn></msup><mi>B</mi></mrow><mrow><mi>g</mi><mspace width="0.167em"></mspace><msup><mi>A</mi><mn>3</mn></msup></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{Q^{2}B}{g\,A^{3}}=1</annotation></semantics></math></p>
<p>where <em>B</em> is the top width of the water surface.</p>
<p>As with full flow in circular pipes, any one of the variables in the
Manning equation, and related geometric variables, may be treated as an
unknown. For an existing pipe, a common problem is the determination of
the depth, <em>y</em> that a given flow <em>Q</em>, will have given a
pipe diameter <em>d</em>, slope <em>S</em> and roughness <em>n</em>. An
example of that follows.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manningc.html">manningc</a></span><span class="op">(</span>Q<span class="op">=</span><span class="fl">0.01</span>, n<span class="op">=</span><span class="fl">0.013</span>, Sf<span class="op">=</span><span class="fl">0.001</span>, d <span class="op">=</span> <span class="fl">0.2</span>, units<span class="op">=</span><span class="st">"SI"</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"pipe"</span>, padding<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">ans</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Q</td>
<td align="left">0.01 [m^3/s]</td>
</tr>
<tr class="even">
<td align="left">V</td>
<td align="left">0.38 [m/s]</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">0.027 [m^2]</td>
</tr>
<tr class="even">
<td align="left">P</td>
<td align="left">0.44 [m]</td>
</tr>
<tr class="odd">
<td align="left">R</td>
<td align="left">0.061 [m]</td>
</tr>
<tr class="even">
<td align="left">y</td>
<td align="left">0.16 [m]</td>
</tr>
<tr class="odd">
<td align="left">d</td>
<td align="left">0.2 [m]</td>
</tr>
<tr class="even">
<td align="left">Sf</td>
<td align="left">0.001 [1]</td>
</tr>
<tr class="odd">
<td align="left">n</td>
<td align="left">0.013 [1]</td>
</tr>
<tr class="even">
<td align="left">yc</td>
<td align="left">0.085 [m]</td>
</tr>
<tr class="odd">
<td align="left">Fr</td>
<td align="left">0.3 [1]</td>
</tr>
<tr class="even">
<td align="left">Re</td>
<td align="left">22343 [1]</td>
</tr>
<tr class="odd">
<td align="left">Qf</td>
<td align="left">0.01 [m^3/s]</td>
</tr>
</tbody>
</table>
<p>For circular pipes, there is also an option to allow Manning
<em>n</em> to vary with depth, in which case the specified <em>n</em> is
assumed to be that corresponding to full pipe flow. The output contains
the <em>n</em> as adjusted.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manningc.html">manningc</a></span><span class="op">(</span>Q<span class="op">=</span><span class="fl">0.01</span>, n<span class="op">=</span><span class="fl">0.013</span>, Sf<span class="op">=</span><span class="fl">0.001</span>, d <span class="op">=</span> <span class="fl">0.2</span>, n_var<span class="op">=</span><span class="cn">TRUE</span>, units<span class="op">=</span><span class="st">"SI"</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"pipe"</span>, padding<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">ans</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Q</td>
<td align="left">0.01 [m^3/s]</td>
</tr>
<tr class="even">
<td align="left">V</td>
<td align="left">0.34 [m/s]</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">0.029 [m^2]</td>
</tr>
<tr class="even">
<td align="left">P</td>
<td align="left">0.48 [m]</td>
</tr>
<tr class="odd">
<td align="left">R</td>
<td align="left">0.06 [m]</td>
</tr>
<tr class="even">
<td align="left">y</td>
<td align="left">0.17 [m]</td>
</tr>
<tr class="odd">
<td align="left">d</td>
<td align="left">0.2 [m]</td>
</tr>
<tr class="even">
<td align="left">Sf</td>
<td align="left">0.001 [1]</td>
</tr>
<tr class="odd">
<td align="left">n</td>
<td align="left">0.014 [1]</td>
</tr>
<tr class="even">
<td align="left">yc</td>
<td align="left">0.085 [m]</td>
</tr>
<tr class="odd">
<td align="left">Fr</td>
<td align="left">0.24 [1]</td>
</tr>
<tr class="even">
<td align="left">Re</td>
<td align="left">20270 [1]</td>
</tr>
<tr class="odd">
<td align="left">Qf</td>
<td align="left">0.01 [m^3/s]</td>
</tr>
</tbody>
</table>
<p>It is also sometimes convenient to see a cross-section diagram.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manningc.html">manningc</a></span><span class="op">(</span>Q<span class="op">=</span><span class="fl">0.01</span>, n<span class="op">=</span><span class="fl">0.013</span>, Sf<span class="op">=</span><span class="fl">0.001</span>, d <span class="op">=</span> <span class="fl">0.2</span>, units<span class="op">=</span><span class="st">"SI"</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/xc_circle.html">xc_circle</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ans</span><span class="op">$</span><span class="va">y</span>, d<span class="op">=</span><span class="va">ans</span><span class="op">$</span><span class="va">d</span>, units <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/manningc-2-1.png" width="40%"></p>
</div>
<div class="section level3">
<h3 id="flow-in-open-channels-rectangular-triangular-trapezoidal">5.0 Flow in Open Channels (rectangular, triangular,
trapezoidal)<a class="anchor" aria-label="anchor" href="#flow-in-open-channels-rectangular-triangular-trapezoidal"></a>
</h3>
<p>As with flow in circular pipes flowing less than full, flow in an
open channel of rectangular, triangular, or trapezoidal shape uses the
Manning equation. Substituting the geometric relationships for hydraulic
radius and cross-sectional area, the Manning equation takes the form:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mfrac><mi>C</mi><mi>n</mi></mfrac><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mi>y</mi><mo>+</mo><mi>m</mi><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mn>5</mn><mn>3</mn></mfrac></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>+</mo><mn>2</mn><mi>y</mi><msqrt><mrow><mn>1</mn><mo>+</mo><msup><mi>m</mi><mn>2</mn></msup></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mn>2</mn><mn>3</mn></mfrac></msup></mfrac><msup><msub><mi>S</mi><mi>f</mi></msub><mfrac><mn>1</mn><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">Q=\frac{C}{n}{\frac{\left(by+my^2\right)^{\frac{5}{3}}}{\left(b+2y\sqrt{1+m^2}\right)^\frac{2}{3}}}{S_f}^{\frac{1}{2}}</annotation></semantics></math>
For a rectangular channel, the side slope is vertical, so <em>m</em> =
0; for a triangular channel, <em>b</em> = 0. For a given <em>Q</em>,
<em>m</em>, <em>n</em>, and <em>Sf</em>, the most hydraulically
efficient channel is found by maximizing R, which can be done by setting
in the Manning equation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><mi>R</mi></mrow><mrow><mi>∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{\partial R}{\partial y}=0</annotation></semantics></math>.
This produces:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>o</mi><mi>p</mi><mi>t</mi></mrow></msub><mo>=</mo><msup><mn>2</mn><mfrac><mn>1</mn><mn>4</mn></mfrac></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>Q</mi><mi>n</mi></mrow><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><msqrt><mrow><mn>1</mn><mo>+</mo><msup><mi>m</mi><mn>2</mn></msup></mrow></msqrt><mo>−</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>S</mi><mi>f</mi><mfrac><mn>1</mn><mn>2</mn></mfrac></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mn>3</mn><mn>8</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">y_{opt} = 2^{\frac{1}{4}}\left(\frac{Qn}{C\left(2\sqrt{1+m^2}-m\right)S_f^{\frac{1}{2}}}\right)^{\frac{3}{8}}</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>o</mi><mi>p</mi><mi>t</mi></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>y</mi><mrow><mi>o</mi><mi>p</mi><mi>t</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mrow><mn>1</mn><mo>+</mo><msup><mi>m</mi><mn>2</mn></msup></mrow></msqrt><mo>−</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b_{opt} = 2y_{opt}\left(\sqrt{1+m^2}-m\right)</annotation></semantics></math></p>
<p>The <em>manningt</em> function works similarly to the function for
circular pipes, in that the excluded argument is the one for which the
function determines a solution. For example, a design might require the
slope to deliver a required flow, <em>Q</em> through a channel with
known geometry (bottom width, <em>b</em>, side slope <em>m</em>) and a
given depth <em>y</em>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manningt.html">manningt</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="fl">360.</span>, n <span class="op">=</span> <span class="fl">0.015</span>, m <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">20.0</span>, y <span class="op">=</span> <span class="fl">3.0</span>, units <span class="op">=</span> <span class="st">"Eng"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Slope: %.5f ft\n"</span>, <span class="va">ans</span><span class="op">$</span><span class="va">Sf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Slope: 0.00088 ft</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"pipe"</span>, padding<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Q</th>
<th align="left">V</th>
<th align="left">A</th>
<th align="left">P</th>
<th align="left">R</th>
<th align="left">y</th>
<th align="left">b</th>
<th align="left">m</th>
<th align="left">Sf</th>
<th align="left">B</th>
<th align="left">n</th>
<th align="left">yc</th>
<th align="left">Fr</th>
<th align="left">Re</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">360</td>
<td align="left">5.2</td>
<td align="left">69</td>
<td align="left">28</td>
<td align="left">2.4</td>
<td align="left">3</td>
<td align="left">20</td>
<td align="left">1</td>
<td align="left">0.00088</td>
<td align="left">26</td>
<td align="left">0.015</td>
<td align="left">2.1</td>
<td align="left">0.56</td>
<td align="left">1146737</td>
</tr></tbody>
</table>
<p>Thus, a longitudinal slope for the channel would need to be 0.00088,
or a drop of 0.88 ft per 1000 ft. The critical depth <em>yc</em> is
lower than the normal depth <em>y</em>, indicating flow under these
conditions is subcritical, also seen with <em>Fr &lt; 1.0</em>.</p>
<p>Units can also be returned by this function.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manningt.html">manningt</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="fl">360.</span>, n <span class="op">=</span> <span class="fl">0.015</span>, m <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">20.0</span>, y <span class="op">=</span> <span class="fl">3.0</span>, units <span class="op">=</span> <span class="st">"Eng"</span>, ret_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"pipe"</span>, padding<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">ans</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Q</td>
<td align="left">360 [ft^3/s]</td>
</tr>
<tr class="even">
<td align="left">V</td>
<td align="left">5.2 [ft/s]</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">69 [ft^2]</td>
</tr>
<tr class="even">
<td align="left">P</td>
<td align="left">28 [ft]</td>
</tr>
<tr class="odd">
<td align="left">R</td>
<td align="left">2.4 [ft]</td>
</tr>
<tr class="even">
<td align="left">y</td>
<td align="left">3 [ft]</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">20 [ft]</td>
</tr>
<tr class="even">
<td align="left">m</td>
<td align="left">1 [1]</td>
</tr>
<tr class="odd">
<td align="left">Sf</td>
<td align="left">0.00088 [1]</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">26 [ft]</td>
</tr>
<tr class="odd">
<td align="left">n</td>
<td align="left">0.015 [1]</td>
</tr>
<tr class="even">
<td align="left">yc</td>
<td align="left">2.1 [ft]</td>
</tr>
<tr class="odd">
<td align="left">Fr</td>
<td align="left">0.56 [1]</td>
</tr>
<tr class="even">
<td align="left">Re</td>
<td align="left">1146737 [1]</td>
</tr>
</tbody>
</table>
<p>A simple diagram can be generated for the channel.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/xc_trap.html">xc_trap</a></span><span class="op">(</span> y <span class="op">=</span> <span class="fl">3.0</span>, b <span class="op">=</span> <span class="fl">20.0</span>, m <span class="op">=</span> <span class="fl">1.0</span>, units <span class="op">=</span> <span class="st">"Eng"</span><span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/manningt-2.1-1.png" width="384"></p>
<p>When solving for flow depth, <em>y</em>, or channel bottom width,
<em>b</em>, an additional variable is returned for the optimal depth,
<em>yopt</em>, or optimal width, <em>bopt</em>. These are optimal for
hydraulic efficiency and practical concerns with construction often
result in designs that flow with depths less than the hydraulic optimum.
Solving a prior example for bottom width illustrates this.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manningt.html">manningt</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="fl">360.</span>, n <span class="op">=</span> <span class="fl">0.015</span>, m <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">3.0</span>, Sf <span class="op">=</span> <span class="fl">0.00088</span>, units <span class="op">=</span> <span class="st">"Eng"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"pipe"</span>, padding<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="12%">
<col width="5%">
<col width="8%">
<col width="5%">
<col width="7%">
<col width="12%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">Q</th>
<th align="left">V</th>
<th align="left">A</th>
<th align="left">P</th>
<th align="left">R</th>
<th align="left">y</th>
<th align="left">b</th>
<th align="left">m</th>
<th align="left">Sf</th>
<th align="left">B</th>
<th align="left">n</th>
<th align="left">yc</th>
<th align="left">Fr</th>
<th align="left">Re</th>
<th align="left">bopt</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">360</td>
<td align="left">5.3</td>
<td align="left">68</td>
<td align="left">28</td>
<td align="left">2.4</td>
<td align="left">3</td>
<td align="left">20</td>
<td align="left">1</td>
<td align="left">0.00088</td>
<td align="left">26</td>
<td align="left">0.015</td>
<td align="left">2.1</td>
<td align="left">0.57</td>
<td align="left">1159705</td>
<td align="left">4.8</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Optimal bottom width: %.5f ft\n"</span>, <span class="va">ans</span><span class="op">$</span><span class="va">bopt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal bottom width: 4.76753 ft</span></span></code></pre></div>
<p>The results show that, aside from the rounding, the width is returned
as expected (approximately 20 ft), and the optimal bottom width for
hydraulic efficiency would be closer to 4.76 ft. To check the depth that
would be associated with a channel of the optimal width, substitute the
optimal width for <em>b</em> and solve for <em>y</em>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manningt.html">manningt</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="fl">360.</span>, n <span class="op">=</span> <span class="fl">0.015</span>, m <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">4.767534</span>, Sf <span class="op">=</span> <span class="fl">0.00088</span>, units <span class="op">=</span> <span class="st">"Eng"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Optimal depth: %.5f ft\n"</span>, <span class="va">ans</span><span class="op">$</span><span class="va">yopt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal depth: 5.75492 ft</span></span></code></pre></div>
<p>For any channel geometry and flow rate a convenient plot is a
specific energy diagram, which illustrates the different flow depths
that can occur for any given specific energy. This is important for
understanding what may happen to the water surface when flow encounters
an obstacle or transition. For the channel of the example above, the
diagram is</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spec_energy_trap.html">spec_energy_trap</a></span><span class="op">(</span> Q <span class="op">=</span> <span class="fl">360</span>, b <span class="op">=</span> <span class="fl">20</span>, m <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">4</span>, units <span class="op">=</span> <span class="st">"Eng"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/manningt-3-1.png" width="384"></p>
<p>This provides an illustration that for y=3 ft the flow is subcritical
(above the critical depth). Specific energy for the conditions of the
prior example is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mi>y</mi><mo>+</mo><mfrac><msup><mi>V</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>g</mi></mrow></mfrac><mo>=</mo><mn>3.0</mn><mo>+</mo><mfrac><msup><mn>5.22</mn><mn>2</mn></msup><mrow><mn>2</mn><mo>*</mo><mn>32.2</mn></mrow></mfrac><mo>=</mo><mn>3.42</mn><mi>f</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">E=y+\frac{V^2}{2g}=3.0+\frac{5.22^2}{2*32.2}=3.42 ft</annotation></semantics></math>.
If the channel bottom had an abrupt rise of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>−</mo><msub><mi>E</mi><mi>c</mi></msub><mo>=</mo><mn>3.42</mn><mo>−</mo><mn>3.03</mn><mo>=</mo><mn>0.39</mn><mi>f</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">E-E_c=3.42-3.03=0.39 ft</annotation></semantics></math>
critical depth would occur over the hump. A rise of anything greater
than that would cause damming to occur. Once flow over a hump is
critical, downstream of the hump the flow will be in supercritical
conditions, flowing at the <em>alternate depth</em>.</p>
<p>The specific energy for a given depth <em>y</em> and alternate depth
can be added to the plot by including an argument for depth, y (two
depths may also be specified using the argument
<code>y=c(&lt;depth1&gt;, &lt;depth2&gt;)</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spec_energy_trap.html">spec_energy_trap</a></span><span class="op">(</span> Q <span class="op">=</span> <span class="fl">360</span>, b <span class="op">=</span> <span class="fl">20</span>, m <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">4</span>, y<span class="op">=</span><span class="fl">3.0</span>, units <span class="op">=</span> <span class="st">"Eng"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/manningt-4-1.png" width="384"></p>
<p>A final example shows how to vary multiple input variables
simultaneously. How does flow <em>Q</em> vary over a range of <em>n</em>
and <em>y</em> values? The <em>expand.grid</em> function produces all
combinations of different variables. The functions can be run for all of
the problem permutations and the results plotted in many different ways.
One example follows.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.011</span>, <span class="fl">0.021</span>, <span class="fl">0.002</span><span class="op">)</span></span>
<span><span class="va">ys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2.1</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">ny</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">ns</span>, y<span class="op">=</span><span class="va">ys</span><span class="op">)</span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">manningt</span>, n <span class="op">=</span> <span class="va">ny</span><span class="op">$</span><span class="va">n</span>, y <span class="op">=</span> <span class="va">ny</span><span class="op">$</span><span class="va">y</span>, MoreArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">2</span>, Sf <span class="op">=</span> <span class="fl">0.0005</span>, b <span class="op">=</span> <span class="fl">3</span>, units <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#to simplify plotting, select columns of interest and change each from list to numeric</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Q<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">Q</span><span class="op">)</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">x2</span>,<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span>,y<span class="op">=</span><span class="va">Q</span>, group<span class="op">=</span><span class="va">n</span>, colour<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"y, m"</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Q, "</span>, <span class="op">~</span><span class="va">m</span><span class="op">^</span><span class="fl">3</span><span class="op">/</span><span class="va">s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/manningt-5-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="pump-curve-and-operating-points">6.0 Pump Curve and Operating Points<a class="anchor" aria-label="anchor" href="#pump-curve-and-operating-points"></a>
</h3>
<p>For any system delivering water through circular pipes with the
assistance of a pump, the selection of the pump requires a consideration
of both the pump characteristics and the energy required to deliver
different flow rates through the system. These are described by the
system and pump characteristic curves. Where they intersect defines the
operating point, the flow and (energy) head at which the pump would
operate in that system.</p>
<div class="figure" style="text-align: center">
<img src="TDH_Example_2_Diagram.png" alt="A simple hydraulic system (from https://www.castlepumps.com)" width="60%"><p class="caption">
A simple hydraulic system (from <a href="https://www.castlepumps.com" class="external-link uri">https://www.castlepumps.com</a>)
</p>
</div>
<p>As described above, for a simple system the loss of head (energy per
unit weight) due to friction,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>f</mi></msub><annotation encoding="application/x-tex">h_f</annotation></semantics></math>,
is described by the Darcy-Weisbach equation, which can be simplified as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>f</mi></msub><mo>=</mo><mfrac><mrow><mi>f</mi><mi>L</mi></mrow><mi>D</mi></mfrac><mfrac><msup><mi>V</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>g</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>8</mn><mi>f</mi><mi>L</mi></mrow><mrow><msup><mi>π</mi><mn>2</mn></msup><mi>g</mi><msup><mi>D</mi><mn>5</mn></msup></mrow></mfrac><msup><mi>Q</mi><mn>2</mn></msup><mo>=</mo><mi>K</mi><mi>Q</mi><msup><mi></mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">h_f = \frac{fL}{D}\frac{V^2}{2g} = \frac{8fL}{\pi^{2}gD^{5}}Q^{2} = KQ{^2}</annotation></semantics></math>
The total dynamic head the system requires a pump to provide,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>p</mi></msub><annotation encoding="application/x-tex">h_p</annotation></semantics></math>,
is found by solving the energy equation from the upstream reservoir
(point 1) to the downstream reservoir (point 2).
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>p</mi></msub><mo>=</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>+</mo><mfrac><mi>P</mi><mi>γ</mi></mfrac><mo>+</mo><mfrac><msup><mi>V</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>g</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msub><mo>−</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>+</mo><mfrac><mi>P</mi><mi>γ</mi></mfrac><mo>+</mo><mfrac><msup><mi>V</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>g</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>1</mn></msub><mo>+</mo><msub><mi>h</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">h_p = \left(z+\frac{P}{\gamma}+\frac{V^2}{2g}\right)_2 - \left(z+\frac{P}{\gamma}+\frac{V^2}{2g}\right)_1+h_f</annotation></semantics></math></p>
<p>For the simple system in this example, the velocity is negligible in
both reservoirs 1 and 2, and the pressures at both reservoirs is
atmospheric, so the equation becomes:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>p</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mn>2</mn></msub><mo>−</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>h</mi><mi>f</mi></msub><mo>=</mo><msub><mi>h</mi><mi>s</mi></msub><mo>+</mo><msub><mi>h</mi><mi>f</mi></msub><mo>=</mo><msub><mi>h</mi><mi>s</mi></msub><mo>+</mo><mi>K</mi><msup><mi>Q</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">h_p = \left(z_2 - z_1\right) + h_f=h_s+h_f=h_s+KQ^2</annotation></semantics></math>
Using the <em>hydraulics</em> package, the coefficient, <em>K</em>, can
be calculated manually or using other package functions for friction
loss in a pipe system using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Q=1</annotation></semantics></math>.
As an example:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/darcyweisbach.html">darcyweisbach</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="fl">1</span>,D <span class="op">=</span> <span class="fl">20</span><span class="op">/</span><span class="fl">12</span>, L <span class="op">=</span> <span class="fl">3884</span>, ks <span class="op">=</span> <span class="fl">0.0005</span>, nu <span class="op">=</span> <span class="fl">1.23e-5</span>, units <span class="op">=</span> <span class="st">"Eng"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Coefficient K: %.3f\n"</span>, <span class="va">ans</span><span class="op">$</span><span class="va">hf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Coefficient K: 0.160</span></span></code></pre></div>
<p>For this example assume a static head of 30 ft and generate a
systemcurve object:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scurve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/systemcurve.html">systemcurve</a></span><span class="op">(</span>hs <span class="op">=</span> <span class="fl">30</span>, K <span class="op">=</span> <span class="va">ans</span><span class="op">$</span><span class="va">hf</span>, units <span class="op">=</span> <span class="st">"Eng"</span><span class="op">)</span></span></code></pre></div>
The pump characteristic curve is based on data or graphs obtained from a
pump manufacturer.
<div class="figure" style="text-align: center">
<img src="goulds_pump_3409.png" alt="A sample set of pump curves (from https://www.gouldspumps.com). The three red dots are points selected to approximate the curve" width="60%"><p class="caption">
A sample set of pump curves (from <a href="https://www.gouldspumps.com" class="external-link uri">https://www.gouldspumps.com</a>). The three red dots are
points selected to approximate the curve
</p>
</div>
<p>The three selected points are used to generate a polynomial fit to
the curve. There are currently three options for the polynomial:</p>
<table class="table">
<thead><tr class="header">
<th align="left">type</th>
<th align="left">Equation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">poly1</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mi>a</mi><mo>+</mo><mi>b</mi><mi>Q</mi><mo>+</mo><mi>c</mi><msup><mi>Q</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">h=a+{b}{Q}+{c}{Q}^2</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left">poly2</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mi>a</mi><mo>+</mo><mi>c</mi><msup><mi>Q</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">h=a+{c}{Q}^2</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left">poly3</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>s</mi><mi>h</mi><mi>u</mi><mi>t</mi><mi>o</mi><mi>f</mi><mi>f</mi></mrow></msub><mo>+</mo><mi>c</mi><msup><mi>Q</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">h_{shutoff}+{c}{Q}^2</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>s</mi><mi>h</mi><mi>u</mi><mi>t</mi><mi>o</mi><mi>f</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">h_{shutoff}</annotation></semantics></math>
value is the pump head at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Q={0}</annotation></semantics></math>.
The coordinates of the points can be input to the <em>pumpcurve</em>
function as numeric vectors. For the flow manufacturer’s pump curves
often use units that are not what the <em>hydraulics</em> package needs,
and the <em>units</em> package provides a convenient way to convert them
as needed.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qgpm</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span>, <span class="fl">7850</span><span class="op">)</span>, <span class="va">gallons</span><span class="op">/</span><span class="va">minute</span><span class="op">)</span></span>
<span><span class="va">qcfs</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">qgpm</span>, <span class="va">ft</span><span class="op">^</span><span class="fl">3</span><span class="op">/</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="va">hft</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">81</span>, <span class="fl">60</span>, <span class="fl">20</span><span class="op">)</span> <span class="co">#units are already in ft so setting units is optional</span></span>
<span><span class="va">pcurve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pumpcurve.html">pumpcurve</a></span><span class="op">(</span>Q <span class="op">=</span> <span class="va">qcfs</span>, h <span class="op">=</span> <span class="va">hft</span>, eq <span class="op">=</span> <span class="st">"poly2"</span>, units <span class="op">=</span> <span class="st">"Eng"</span><span class="op">)</span></span></code></pre></div>
<p>The function <em>pumpcurve</em> returns a <em>pumpcurve</em> object
that includes the polynomial fit equation and a simple plot to check the
fit.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcurve</span><span class="op">$</span><span class="va">p</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/pump-7-1.png" width="700"></p>
<p>The two curves can be combined to find the operating point of the
selected pump in the defined system.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oppt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/operpoint.html">operpoint</a></span><span class="op">(</span>pcurve <span class="op">=</span> <span class="va">pcurve</span>, scurve <span class="op">=</span> <span class="va">scurve</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Operating Point: Q = %.3f, h = %.3f\n"</span>, <span class="va">oppt</span><span class="op">$</span><span class="va">Qop</span>, <span class="va">oppt</span><span class="op">$</span><span class="va">hop</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Operating Point: Q = 12.051, h = 53.285</span></span>
<span><span class="va">oppt</span><span class="op">$</span><span class="va">p</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_function()`).</span></span></code></pre></div>
<p><img src="hydraulics_vignette_files/figure-html/pump-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="pipe-networks-and-the-hardy-cross-method">7.0 Pipe Networks and the Hardy-Cross method<a class="anchor" aria-label="anchor" href="#pipe-networks-and-the-hardy-cross-method"></a>
</h3>
<p>For water pipe networks containing multiple loops a typical method to
solve for the flow in each pipe segment uses the Hardy-Cross method.
This consists of setting up an initial guess of flow (magnitude and
direction) for each pipe segment, ensuring conservation of mass is
preserved at each node (or vertex) in the network. Then calculations are
performed for each loop, ensuring energy is conserved.</p>
<p>In the <em>hydraulics</em> package, the Darcy-Weisbach equation is
used to estimate the head loss in each pipe segment, expressed in a
condensed form as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>f</mi></msub><mo>=</mo><mi>K</mi><msup><mi>Q</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{h_f = KQ^{2}}</annotation></semantics></math>
where:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mfrac><mrow><mn>8</mn><mi>f</mi><mi>L</mi></mrow><mrow><msup><mi>π</mi><mn>2</mn></msup><mi>g</mi><msup><mi>D</mi><mn>5</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">{K = \frac{8fL}{\pi^{2}gD^{5}}}</annotation></semantics></math>
If needed, the friction factor <em>f</em> is calculated using the
Colebrook equation. The flow adjustment in each loop is calculated at
each iteration as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msub><mi>Q</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>p</mi><mi>i</mi></msub></munderover><msub><mi>K</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>Q</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>Q</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>p</mi><mi>i</mi></msub></munderover><mn>2</mn><msub><mi>K</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msubsup><mi>Q</mi><mi>j</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">{\Delta{Q_i} = -\frac{\sum_{j=1}^{p_i} K_{ij}Q_j|Q_j|}{\sum_{j=1}^{p_i} 2K_{ij}Q_j^2}}</annotation></semantics></math>
where <em>i</em> is the loop number, <em>j</em> is the pipe number,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">{p_i}</annotation></semantics></math>
is the number of pipes in loop <em>i</em> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msub><mi>Q</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\Delta{Q_i}}</annotation></semantics></math>
is the flow adjustment to be applied to each pipe in loop <em>i</em> for
the next iteration. Pipes shared between loops receive adjustments from
both loops.</p>
<p>Input consists of pipe characteristics, pipe order and initial flows
for each loop, the number of iterations to perform, and the unit system
being used (only needed if fixed <em>K</em> values are not
provided).</p>
<div class="figure" style="text-align: center">
<img src="hardycross_system.png" alt="A sample pipe network with pipe numbers indicated in black" width="75%"><p class="caption">
A sample pipe network with pipe numbers indicated in black
</p>
</div>
<p>Input for this system, assuming fixed <em>f</em> values, would look
like the following. (If fixed <em>K</em> values are provided, f, L and D
are not needed). These <em>f</em> values were estimated using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>s</mi><mo>=</mo><mn>0.00025</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">ks=0.00025 m</annotation></semantics></math>
in the form of the Colebrook equation for fully rough flows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msqrt><mi>f</mi></msqrt></mfrac><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>3.7</mn><mfrac><mrow><mi>k</mi><mi>s</mi></mrow><mi>D</mi></mfrac></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{1}{\sqrt{f}}=log\left(\frac{3.7}{\frac{ks}{D}}\right)</annotation></semantics></math>
This simplification removes the velocity dependence of <em>f</em>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfpipes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span>,                                <span class="co">#pipe ID</span></span>
<span>  D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.15</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.25</span><span class="op">)</span>,         <span class="co">#diameter in m</span></span>
<span>  L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fl">100</span>,<span class="fl">125</span>,<span class="fl">125</span>,<span class="fl">100</span>,<span class="fl">100</span>,<span class="fl">125</span>,<span class="fl">100</span>,<span class="fl">100</span>,<span class="fl">125</span><span class="op">)</span>,              <span class="co">#length in m</span></span>
<span>  f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.01879</span>,<span class="fl">.02075</span>,<span class="fl">.02075</span>,<span class="fl">.02075</span>,<span class="fl">.02075</span>,<span class="fl">.02233</span>,<span class="fl">.01964</span>,<span class="fl">.02233</span>,<span class="fl">.02233</span>,<span class="fl">.01964</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">loops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.040</span>,<span class="fl">.040</span>,<span class="fl">.02</span>,<span class="op">-</span><span class="fl">.02</span>,<span class="op">-</span><span class="fl">.04</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.02</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">.02</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.02</span>,<span class="fl">.02</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Running it and looking at the output after three iterations:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hardycross.html">hardycross</a></span><span class="op">(</span>dfpipes <span class="op">=</span> <span class="va">dfpipes</span>, loops <span class="op">=</span> <span class="va">loops</span>, Qs <span class="op">=</span> <span class="va">Qs</span>, n_iter <span class="op">=</span> <span class="fl">3</span>, units <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ans</span><span class="op">$</span><span class="va">dfloops</span>, digits <span class="op">=</span> <span class="fl">4</span>, format <span class="op">=</span> <span class="st">"pipe"</span>, padding<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">loop</th>
<th align="right">pipe</th>
<th align="right">flow</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.0383</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0.0383</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">0.0232</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">-0.0258</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">-0.0417</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">0.0258</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0.0090</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">7</td>
<td align="right">0.0041</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">8</td>
<td align="right">-0.0159</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">-0.0232</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">9</td>
<td align="right">0.0151</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">10</td>
<td align="right">-0.0049</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">6</td>
<td align="right">-0.0090</td>
</tr>
</tbody>
</table>
<p>The output pipe data frame has added columns, including the flow
(where direction is that for the first loop containing the segment).</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ans</span><span class="op">$</span><span class="va">dfpipes</span>, digits <span class="op">=</span> <span class="fl">4</span>, format <span class="op">=</span> <span class="st">"pipe"</span>, padding<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ID</th>
<th align="right">D</th>
<th align="right">L</th>
<th align="right">f</th>
<th align="right">Q</th>
<th align="right">K</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.30</td>
<td align="right">250</td>
<td align="right">0.0188</td>
<td align="right">0.0383</td>
<td align="right">159.7828</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.20</td>
<td align="right">100</td>
<td align="right">0.0208</td>
<td align="right">0.0383</td>
<td align="right">535.9666</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.20</td>
<td align="right">125</td>
<td align="right">0.0208</td>
<td align="right">0.0232</td>
<td align="right">669.9582</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.20</td>
<td align="right">125</td>
<td align="right">0.0208</td>
<td align="right">-0.0258</td>
<td align="right">669.9582</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.20</td>
<td align="right">100</td>
<td align="right">0.0208</td>
<td align="right">-0.0417</td>
<td align="right">535.9666</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">0.0223</td>
<td align="right">0.0090</td>
<td align="right">2430.5356</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.25</td>
<td align="right">125</td>
<td align="right">0.0196</td>
<td align="right">0.0041</td>
<td align="right">207.7883</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">0.0223</td>
<td align="right">-0.0159</td>
<td align="right">2430.5356</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">0.0223</td>
<td align="right">0.0151</td>
<td align="right">2430.5356</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.25</td>
<td align="right">125</td>
<td align="right">0.0196</td>
<td align="right">-0.0049</td>
<td align="right">207.7883</td>
</tr>
</tbody>
</table>
<p>While the Hardy-Cross method is often used with fixed <em>f</em> (or
<em>K</em>) values because it is used in exercises performed by hand,
the use of the Colebrook equation allows friction losses to vary with
Reynolds number. To use this approach the input data must include
absolute roughness. Example values are included here:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfpipes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span>,                         <span class="co">#pipe ID</span></span>
<span>  D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.15</span>,<span class="fl">0.25</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.25</span><span class="op">)</span>,  <span class="co">#diameter in m</span></span>
<span>  L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fl">100</span>,<span class="fl">125</span>,<span class="fl">125</span>,<span class="fl">100</span>,<span class="fl">100</span>,<span class="fl">125</span>,<span class="fl">100</span>,<span class="fl">100</span>,<span class="fl">125</span><span class="op">)</span>,       <span class="co">#length in m</span></span>
<span>  ks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.00025</span>,<span class="fl">10</span><span class="op">)</span>                                  <span class="co">#absolute roughness, m</span></span>
<span><span class="op">)</span></span>
<span><span class="va">loops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.040</span>,<span class="fl">.040</span>,<span class="fl">.02</span>,<span class="op">-</span><span class="fl">.02</span>,<span class="op">-</span><span class="fl">.04</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.02</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">.02</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.02</span>,<span class="fl">.02</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The effect of allowing the calculation of <em>f</em> to be
(correctly) dependent on velocity (via the Reynolds number) can be seen,
though the effect on final flow values is small.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hardycross.html">hardycross</a></span><span class="op">(</span>dfpipes <span class="op">=</span> <span class="va">dfpipes</span>, loops <span class="op">=</span> <span class="va">loops</span>, Qs <span class="op">=</span> <span class="va">Qs</span>, n_iter <span class="op">=</span> <span class="fl">3</span>, units <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ans</span><span class="op">$</span><span class="va">dfpipes</span>, digits <span class="op">=</span> <span class="fl">4</span>, format <span class="op">=</span> <span class="st">"pipe"</span>, padding<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ID</th>
<th align="right">D</th>
<th align="right">L</th>
<th align="right">ks</th>
<th align="right">Q</th>
<th align="right">f</th>
<th align="right">K</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.30</td>
<td align="right">250</td>
<td align="right">3e-04</td>
<td align="right">0.0382</td>
<td align="right">0.0207</td>
<td align="right">176.1877</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.20</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">0.0382</td>
<td align="right">0.0218</td>
<td align="right">562.9732</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.20</td>
<td align="right">125</td>
<td align="right">3e-04</td>
<td align="right">0.0230</td>
<td align="right">0.0224</td>
<td align="right">723.1119</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.20</td>
<td align="right">125</td>
<td align="right">3e-04</td>
<td align="right">-0.0258</td>
<td align="right">0.0222</td>
<td align="right">718.1439</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.20</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">-0.0418</td>
<td align="right">0.0217</td>
<td align="right">560.8321</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">0.0088</td>
<td align="right">0.0248</td>
<td align="right">2700.4710</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.25</td>
<td align="right">125</td>
<td align="right">3e-04</td>
<td align="right">0.0040</td>
<td align="right">0.0280</td>
<td align="right">296.3990</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">-0.0160</td>
<td align="right">0.0238</td>
<td align="right">2590.2795</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.15</td>
<td align="right">100</td>
<td align="right">3e-04</td>
<td align="right">0.0152</td>
<td align="right">0.0239</td>
<td align="right">2598.5553</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.25</td>
<td align="right">125</td>
<td align="right">3e-04</td>
<td align="right">-0.0048</td>
<td align="right">0.0270</td>
<td align="right">285.4983</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="miscellaneous-functions">8.0 Miscellaneous functions<a class="anchor" aria-label="anchor" href="#miscellaneous-functions"></a>
</h3>
<p>Other functions have been added to the <em>hydraulics</em> package to
add some capabilities for calculations related to gradually- and
rapidly-varied flow. Additional documentation on these may be found in
the online reference <a href="https://edm44.github.io/hydr-watres-book/" class="external-link">Hydraulics and Water
Resources: Examples Using R</a>.</p>
</div>
<div class="section level3">
<h3 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h3>
<p><a href="https://cran.r-project.org/web/licenses/GPL-3" class="external-link">GPL-3</a>
2024-11-18 Ed Maurer</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ed Maurer, Irucka Embry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
